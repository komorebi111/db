"use strict";(self["webpackChunkdb"]=self["webpackChunkdb"]||[]).push([[215],{7984:function(){},6215:function(e,l,i){i.r(l),i.d(l,{default:function(){return P}});var o=i(1404),a=i(3396),t=i(4870),n=i(610),r=i(5323),s=i(7936),d=i(253),c=i(3444);const u=Symbol(),m=()=>(0,a.f3)(u,null);var f=i(2229);const[v,h,g]=(0,n["do"])("list"),p={error:Boolean,offset:(0,r.SI)(300),loading:Boolean,finished:Boolean,errorText:String,direction:(0,r.SQ)("down"),loadingText:String,finishedText:String,immediateCheck:r.J5};var b=(0,a.aZ)({name:v,props:p,emits:["load","update:error","update:loading"],setup(e,{emit:l,slots:i}){const o=(0,t.iH)(e.loading),n=(0,t.iH)(),r=(0,t.iH)(),u=m(),v=(0,d.eo)(n),p=()=>{(0,a.Y3)((()=>{if(o.value||e.finished||e.error||!1===(null==u?void 0:u.value))return;const{offset:i,direction:a}=e,t=(0,d.EL)(v);if(!t.height||(0,s.xj)(n))return;let c=!1;const m=(0,d.EL)(r);c="up"===a?t.top-m.top<=i:m.bottom-t.bottom<=i,c&&(o.value=!0,l("update:loading",!0),l("load"))}))},b=()=>{if(e.finished){const l=i.finished?i.finished():e.finishedText;if(l)return(0,a.Wm)("div",{class:h("finished-text")},[l])}},k=()=>{l("update:error",!1),p()},w=()=>{if(e.error){const l=i.error?i.error():e.errorText;if(l)return(0,a.Wm)("div",{role:"button",class:h("error-text"),tabindex:0,onClick:k},[l])}},_=()=>{if(o.value&&!e.finished)return(0,a.Wm)("div",{class:h("loading")},[i.loading?i.loading():(0,a.Wm)(f.g,{class:h("loading-icon")},{default:()=>[e.loadingText||g("loading")]})])};return(0,a.YP)((()=>[e.loading,e.finished,e.error]),p),u&&(0,a.YP)(u,(e=>{e&&p()})),(0,a.ic)((()=>{o.value=e.loading})),(0,a.bv)((()=>{e.immediateCheck&&p()})),(0,c.F)({check:p}),(0,d.OR)("scroll",p,{target:v,passive:!0}),()=>{var l;const t=null==(l=i.default)?void 0:l.call(i),s=(0,a.Wm)("div",{ref:r,class:h("placeholder")},null);return(0,a.Wm)("div",{ref:n,role:"feed",class:h(),"aria-busy":o.value},["down"===e.direction?t:s,_(),b(),w(),"up"===e.direction?t:s])}}});const k=(0,o.n)(b);i(1958),i(2939);var w=i(9939),_=(i(8185),i(3)),x=(i(6171),i(147)),S=(i(368),i(6742),i(3094),i(7984),i(9420)),y=(i(2097),i(7658),i(7139)),W=i(678),C=i(4471);const I=e=>(0,C.Z)({url:"/search.php",params:{key:e}}),V={class:"container"},T={class:"search-box"},Y={key:0,class:"list"},z=["onClick"],H={class:"right"},U={class:"title"},j={class:"rate"},q={class:"text"},D={class:"info"},E={class:"label"},B={class:"des"};var F={__name:"Search",setup(e){const l=(0,W.tv)(),i=((0,W.yj)(),()=>{history.back()}),o=()=>{n(r.value)},n=async e=>{const{data:l}=await I(e);l.forEach((e=>{e.mImg="http://localhost:9999/"+e.mImg,e.cmScore=parseFloat(e.mScore)/2})),r.list=l};(0,a.bv)((async()=>{const e=document.querySelector(".van-field__control");e.focus()}));const r=(0,t.qj)({value:"",list:[]}),s=e=>{l.push({name:"FilmInfo",query:{mId:e}})};return(e,l)=>{const t=S.l,n=x.o,d=_.E,c=w.j,u=k;return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(t,{title:"搜索",fixed:"",placeholder:"",border:!1,"left-arrow":"",onClickLeft:i}),(0,a._)("div",V,[(0,a._)("div",T,[(0,a.Wm)(n,{placeholder:"搜索",onSearch:o,modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value=e)},null,8,["modelValue"])]),r.list.length>0?((0,a.wg)(),(0,a.iD)("div",Y,[(0,a.Wm)(u,{"immediate-check":!1,loading:e.loading,"onUpdate:loading":l[1]||(l[1]=l=>e.loading=l),"finished-text":e.没有更多了},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.list,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"list-item",key:e.mId},[(0,a._)("div",{class:"img",onClick:l=>s(e.mId)},[(0,a.Wm)(d,{width:"60",height:"76",src:e.mImg},null,8,["src"])],8,z),(0,a._)("div",H,[(0,a._)("div",U,[(0,a.Uk)((0,y.zw)(e.mName)+"  ",1),(0,a._)("span",null,"("+(0,y.zw)(e.mYear)+")",1)]),(0,a._)("div",j,[(0,a.Wm)(c,{color:"#ffac2d",modelValue:e.cmScore,"onUpdate:modelValue":l=>e.cmScore=l,readonly:"","allow-half":""},null,8,["modelValue","onUpdate:modelValue"]),(0,a._)("div",q,(0,y.zw)(2*e.cmScore),1)]),(0,a._)("div",D,[(0,a._)("div",E,(0,y.zw)(e.mClass),1),(0,a._)("div",B,(0,y.zw)(e.mAddr),1)])])])))),128))])),_:1},8,["loading","finished-text"])])):(0,a.kq)("",!0)])],64)}}},L=i(89);const Z=(0,L.Z)(F,[["__scopeId","data-v-2bb3b1c5"]]);var P=Z}}]);
//# sourceMappingURL=215.8cb0c776.js.map